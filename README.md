[![License: MIT][license]][license-url]
[![npm][npm]][npm-url]
[![node][node]][node-url]
[![issues][issues]][issues-url]
[![size][size]][size-url]


# PluginPatchPlugin

The `PluginPatchPlugin` plugin for webpack 5 allows you to patch other Webpack plugins with updated options at runtime.

This plugin is usefull in many situations, e.g. if the primary webpack configuration is generated by a build tool and only merges your custom configurations where you can only add but can not replace plugin settings. Also if you need to dynamically adjust your build in unpredictable cases, safe time and patch your process at runtime.

> [!CAUTION]
> Use this plugin with caution! Using this plugin might cause huge side-effects and could break your build process. 

## Peer dependencies

This plugin requires [Webpack 5](https://webpack.js.org/) as peer dependency, older versions of Webpack are not supported.
If you don't use webpack or if you do not intend to use it, this plugin is not of any use for you.

## Getting Started

To begin, you'll need to install `plugin-patch-plugin`:

``` console
npm install --save-dev plugin-patch-plugin
```

or

``` console
yarn add -D plugin-patch-plugin
```

or

``` console
pnpm add -D plugin-patch-plugin
```

## Plugin Arguments

| Name             | Type                     | Explanation |
| ---------------- | ------------------------ | - | 
| pluginIdentifier | Function \| string       | Either the pluginâ€™s constructor (class) or its constructor name as a string. |
| patchOption      | Function \| object \| [] | The new options you want to override/merge for the patched plugin.<br> Review the [documentation of the plugin](https://webpack.js.org/plugins/) that you want to patch. You can either provide an array of arguments for plugin's contructor, or an options object if the plugin is configured by a single argument being an object of options, or you can provide a function returning either of them. In case of an options object, the provided options will be merged with the options of the existing plugin. |
| hookName         | string                   | Optional name of the compiler hook to tap into, defaults to 'environment'.<br> See https://webpack.js.org/api/compiler-hooks/ for a list of available hooks. |

## Example

``` javascript
module.exports = {
  plugins: [
    new optimize.LimitChunkCountPlugin({
        maxChunks: 5
    }),
    new PluginPatchPlugin(optimize.LimitChunkCountPlugin, {
        maxChunks: 10
    })
  ]
}
```

In this example, during runtime, early in the build process, the `PluginPatchPlugin` replaces the `LimitChunkCountPlugin` with a new instance of the plugin with option `maxChunk = 10`.
The `PluginPatchPlugin` remains in the array of plugins but will not do anything else further in the process.

At runtime, after the The PluginPatchPlugin has been run, the plugins array of your configuration will look like this:

``` javascript
  plugins: [
    new optimize.LimitChunkCountPlugin({
        maxChunks: 10 // changed
    }),
    new PluginPatchPlugin(optimize.LimitChunkCountPlugin, {
        maxChunks: 10
    })
  ]
````

## Usage patterns

Depending on the patched plugin and your specific requirements, choose one fo the four possible usage patterns:

### 1. Options object 

```` javascript
    new PluginPatchPlugin(plugin.constructor, {
        option1: value1,
        option2: value2,
    })
````

### 2. Function returning an options object

```` javascript
    new PluginPatchPlugin(plugin.constructor, () => {
        option1: value1,
        option2: value2,
    })
````

### 3. arguments list 

```` javascript
    new PluginPatchPlugin(plugin.constructor, [
        arg1,
        arg2
    ])
````

### 4. Function returning an arguments list

```` javascript
    new PluginPatchPlugin(plugin.constructor, () => {
        arg1,
        arg2
    })
````

[license]: https://img.shields.io/badge/License-MIT-green.svg
[license-url]: https://opensource.org/licenses/MIT
[npm]: https://img.shields.io/npm/v/plugin-patch-plugin.svg
[npm-url]: https://npmjs.com/package/plugin-patch-plugin
[node]: https://img.shields.io/node/v/plugin-patch-plugin.svg
[node-url]: https://nodejs.org
[issues]: https://img.shields.io/github/issues/kriede/plugin-patch-plugin
[issues-url]: https://github.com/kriede/plugin-patch-plugin/issues
[size]: https://packagephobia.now.sh/badge?p=plugin-patch-plugin
[size-url]: https://packagephobia.now.sh/result?p=plugin-patch-plugin
